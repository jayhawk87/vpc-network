---

copyright:
  years: 2018, 2019
  
lastupdated: "2019-02-20"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:note: .note}
{:important: .important}
{:download: .download}

# 使用 IP 地址范围、地址前缀、区域和子网 
{: #working-with-ip-address-ranges-address-prefixes-regions-and-subnets}

本文档概述了与区域和子网以及地址前缀相关的可用（或受限）IP 地址范围和用户操作。某些 IP 地址范围由于可能被 IBM Cloud 使用而不可用。  

在 {{site.data.keyword.cloud}} VPC 中创建子网时，将根据您在其中创建 VPC 的区域和专区自动分配_地址前缀_。您可以使用缺省地址前缀，在许多情况下也可以手动更改地址前缀，包括 BYOIP 地址。 

## IBM Cloud VPC 和区域

{{site.data.keyword.cloud}} VPC 部署在一个区域中，但可能会跨多个专区。每个区域可包含多个专区，专区表示独立的故障区。

对于 VPC 中的子网，会根据在其中创建这些子网的区域和专区，为其分配_地址前缀_。下表显示了可用的区域和专区。 

|位置|区域|API 端点|状态|
| ------- | :------: | :------: |:------: |
|达拉斯|us-south|`us-south.iaas.cloud.ibm.com`|可用|
|法兰克福|eu-de|`eu-de.iaas.cloud.ibm.com`|可用|
|华盛顿特区|us-east|`us-east.iaas.cloud.ibm.com`|即将提供|
|东京|jp-tok|`jp-tok.iaas.cloud.ibm.com`|即将提供|
|伦敦|eu-gb|`eu-gb.iaas.cloud.ibm.com`|即将提供|
|悉尼|au-syd|`au-syd.iaas.cloud.ibm.com`|即将提供|

## IBM Cloud VPC 和子网

客户可以将 IBM Cloud VPC 划分成子网（作为最佳实践，通常也会这样做）。IBM Cloud VPC 中的所有子网都可以借助隐式路由器通过专用 L3 路由相互访问。您无需设置任何路由器或路径。 

有关 VPC 中子网的有用事实：

* 子网由指定的 IP 地址范围组成。 
* 子网绑定到单个专区，不能跨多个专区或区域。
* 但是，子网可以跨 IBM Cloud VPC 中的整个专区。
* 必须先创建 VPC，然后才能在该 VPC 中创建子网。
* IPv6 支持不可用。
* 可以将 VSI 关联到子网或解除 VSI 与子网的关联。（这需要添加 vNIC 并选择带宽。）

您可以将自己的公共 IPv4 地址范围 (BYOIP) 添加到 IBM Cloud VPC 帐户。使用 BYOIP 时，IBM Cloud 必须在 IBM Cloud 资源上配置这些 IPv4 地址，这将向提供的地址发送包以及接收来自这些地址的包。因此，在 IBM Cloud 上使用提供的 IPv4 范围时，在您使用此服务的过程中，这些 IP 地址可能会向 IBM 的支持人员和第三方公开。
{:important}

**图：显示专区、区域和子网的 VPC 图形表示法。**

![IBM Cloud VPC](images/vpc-experience.png)

## 使用子网的地址前缀

每个子网必须存在于地址前缀中。
 * 为每个专区预先分配了子网地址前缀。
 * 对于新子网，可以从现有地址前缀中选取 IP 地址范围。
 * 如果专区的地址前缀不适用，那么可以编辑其中一个现有地址前缀，也可以为专区添加新的地址前缀（使用 API、CLI 或 UI 来添加）。
 
### 缺省 VPC 地址前缀
 
创建新的 VPC 时，将根据区域和专区来分配缺省地址前缀，如下所示：
 
* 'us-south-1' = '10.240.0.0/18'
* 'us-south-2' = '10.240.64.0/18'

其他专区或区域可能会分配不同的缺省前缀，包括：
 
 * 10.240.0.0/18
 * 10.240.64.0/18
 * 10.240.128.0/18
 
### 地址前缀和 IBM Cloud 控制台 UI
 
使用 IBM Cloud 控制台 UI 创建 VPC 时，系统会自动选择地址前缀，并要求您在该缺省前缀中创建子网。如果此地址方案不符合您的需求，那么可以在创建 VPC 后定制地址前缀。然后，可以在定制的地址前缀中创建子网，并删除使用缺省前缀创建的子网。
 
需要此变通方法，才能通过 IBM Cloud 控制台 UI 使用 BYOIP。
{:note}

### 可用的 IP 地址

下面是 **RFC 1918** 中定义的可用 IP 地址：

 * 10.0.0.0 – 10.255.255.255
 * 172.16.0.0 – 172.31.255.255
 * 192.168.0.0 – 192.168.255.255

### 以下地址是子网中的保留地址

在此列表中，IP 地址假定子网的 CIDR 范围为 10.10.10.0/24：

  * CIDR 范围中的第一个地址 (10.10.10.0)：网络地址
  * CIDR 范围中的第二个地址 (10.10.10.1)：网关地址
  * CIDR 范围中的第三个地址 (10.10.10.2)：被 IBM 保留
  * CIDR 范围中的第四个地址 (10.10.10.3)：被 IBM 保留供未来使用
  * CIDR 范围中的最后一个地址 (10.10.10.255)：网络广播地址

### 有关创建子网的更多信息

有两种方法可为 VPC 指定子网：
  * 可以通过提供所需的子网大小（例如，支持的地址数，如 1024）来创建子网
  * 可以通过提供 CIDR 范围（例如，10.0.0.1/29）来创建子网
  
作为如何使用 CIDR 指定一个 1024 块的示例，如果指定的是 CIDR 范围而不是子网大小，那么 IPv4 块 `192.168.100.0/22` 表示从 `192.168.100.0` 到 `192.168.103.255` 的 1024 个 IPv4 地址。
{:tip}

### 有关删除子网的更多信息
  * 如果子网中正在使用资源（例如，虚拟服务器实例 (VSI)、浮动 IP 或公共网关），那么不能删除该子网，必须先删除这些资源。
  * 无法调整现有子网的大小。例如，无法将 10.10.10.0/24 的大小调整为 10.5.1.3/20。
