---

copyright:
  years: 2018, 2019
  
lastupdated: "2019-02-20"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:note: .note}
{:important: .important}
{:download: .download}

# IP アドレス範囲、アドレス接頭部、リージョン、およびサブネットの操作 
{: #working-with-ip-address-ranges-address-prefixes-regions-and-subnets}

この資料では、リージョン、サブネット、およびアドレス接頭部に関して使用できる (または使用制限のある) IP アドレス範囲とユーザー操作について概説します。IBM Cloud によって使用されるために、使用できない IP アドレス範囲がいくつかあります。  

{{site.data.keyword.cloud}} VPC 内にサブネットを 1 つ作成すると、その VPC が作成されたリージョンとゾーンに基づいて、_アドレス接頭部_ が 1 つ自動的に割り当てられます。そのデフォルトのアドレス接頭部を使用することも、アドレス接頭部を手動で変更することもできます。多くの場合は BYOIP アドレスを含むように変更されます。 

## IBM Cloud VPC とリージョン

{{site.data.keyword.cloud}} VPC は 1 つのリージョンにデプロイされます。ただし、複数のゾーンをまたぐことができます。各リージョンには複数のゾーンが含まれています。ゾーンは、独立したフォールト・ドメインを表します。 

VPC 内のサブネットには、サブネットが作成されたリージョンとゾーンに基づいて_アドレス接頭部_ が割り当てられます。次の表に、使用可能なリージョンとゾーンを示します。 

|   ロケーション     | リージョン | API エンドポイント | 状況 |
| ------- | :------: | :------: |:------: |
| ダラス | us-south | `us-south.iaas.cloud.ibm.com`| 使用可能 |
| フランクフルト | eu-de | `eu-de.iaas.cloud.ibm.com`| 使用可能 |
| ワシントン DC | us-east | `us-east.iaas.cloud.ibm.com`| 近日対応 |
| 東京 | jp-tok | `jp-tok.iaas.cloud.ibm.com`| 近日対応 |
| ロンドン | eu-gb | `eu-gb.iaas.cloud.ibm.com`| 近日対応 |
| シドニー | au-syd | `au-syd.iaas.cloud.ibm.com`| 近日対応 |

## IBM Cloud VPC とサブネット

お客様は IBM Cloud VPC をサブネットに分割できます (通常はベスト・プラクティスとしてこの操作を行います)。IBM Cloud VPC 内のすべてのサブネットは、暗黙的なルーターによるプライベート L3 ルーティングを使用して相互にアクセスできます。ルーターや経路をセットアップする必要はありません。 

VPC のサブネットについて簡単に説明します。

* サブネットには、各自が指定する IP アドレス範囲があります。 
* サブネットは 1 つのゾーンにバインドされ、複数のゾーンまたはリージョンをまたぐことはできません。
* IBM Cloud VPC のゾーン全体を 1 つのサブネットにすることができます。
* VPC 内にサブネットを作成する前に、VPC を作成する必要があります。
* IPv6 には対応していません。
* VSI をサブネットに関連付けたり、関連付けを解除したりできます (この場合、vNIC を追加して帯域幅を選択する必要があります)。

自分で所有するパブリック IPv4 アドレス範囲を IBM Cloud VPC アカウントに持ち込むことができます (この手法を BYOIP といいます)。 BYOIP を使用する場合、IBM Cloud は、提供されたアドレスとの間でパケットを送信する IBM Cloud リソース上にこれらの IPv4 アドレスを構成する必要があります。 そのため、提供された IPv4 範囲を IBM Cloud で使用すると、このサービスを使用する際にこれらの IP アドレスが IBM のサポート担当員および第三者に公開される可能性があります。
{:important}

**図: ゾーン、リージョン、およびサブネットが示されている VPC のグラフィカル表現。**

![IBM Cloud VPC](images/vpc-experience.png)

## サブネットのアドレス接頭部の使用

各サブネットは 1 つのアドレス接頭部の範囲内になければなりません。
 * サブネットのアドレス接頭部は、ゾーンごとに事前割り当てされています。
 * 新しいサブネットの場合、既存のアドレス接頭部から IP アドレス範囲を選択できます。
 * ゾーンのアドレス接頭部が適切でない場合は、既存のアドレス接頭部の 1 つを編集するか、API、CLI、または UI を使用してゾーンの新しいアドレス接頭部を追加することができます。
 
### デフォルトの VPC アドレス接頭部
 
新しい VPC が作成されると、リージョンとゾーンに基づいてデフォルトのアドレス接頭部が以下のように割り当てられます。
 
* 'us-south-1' = '10.240.0.0/18'
* 'us-south-2' = '10.240.64.0/18'

その他のゾーンまたはリージョンでは、次に挙げるような複数の異なるデフォルト接頭部が割り当てられる可能性があります。
 
 * 10.240.0.0/18
 * 10.240.64.0/18
 * 10.240.128.0/18
 
### アドレス接頭部と IBM Cloud コンソール UI
 
IBM Cloud コンソール UI を使用して VPC を作成するときには、アドレス接頭部がシステムで自動的に選択されるので、ユーザーはそのデフォルト接頭部の中でサブネットを作成する必要があります。 このアドレス体系がお客様の要件に適していない場合は、VPC の作成後にアドレス接頭部をカスタマイズできます。 その後、カスタマイズしたアドレス接頭部にサブネットを作成し、デフォルト接頭部を使用して作成したサブネットを削除できます。
 
IBM Cloud コンソール UI で BYOIP を使用するためには、この回避策が必要です。
{:note}

### 使用可能な IP アドレス

**RFC 1918** で定義されている使用可能な IP アドレスを以下に示します。

 * 10.0.0.0 – 10.255.255.255
 * 172.16.0.0 – 172.31.255.255
 * 192.168.0.0 – 192.168.255.255

### 以下のアドレスは、サブネットの予約済みアドレスです

このリストに示す IP アドレスでは、サブネットの CIDR 範囲が 10.10.10.0/24 であることを前提としています。

  * CIDR 範囲内の 1 番目のアドレス (10.10.10.0): ネットワーク・アドレス
  * CIDR 範囲内の 2 番目のアドレス (10.10.10.1): ゲートウェイ・アドレス
  * CIDR 範囲内の 3 番目のアドレス (10.10.10.2): IBM により予約済み
  * CIDR 範囲内の 4 番目のアドレス (10.10.10.3): IBM により将来の使用のために予約済み
  * CIDR 範囲内の最後のアドレス (10.10.10.255): ネットワーク・ブロードキャスト・アドレス

### サブネット作成方法の詳細

VPC のサブネットは、次の 2 とおりの方法で指定できます。
  * サブネットを作成するには、サポートされるアドレスの数 (例: 1024) など、必要なサブネットのサイズを指定します
  * CIDR 範囲 (10.0.0.1/29 など) を指定してサブネットを作成できます
  
CIDR を使用して 1024 ブロックを指定する方法の例として、サブネット・サイズではなく CIDR 範囲を指定する場合、IPv4 ブロック `192.168.100.0/ 22` は、`192.168.100.0` から `192.168.103.255` までの 1024 個の IPv4 アドレスを表します。
{:tip}

### サブネット削除方法の詳細
  * 使用中のリソース (仮想サーバー・インスタンス (VSI)、浮動 IP、パブリック・ゲートウェイなど) があるサブネットを削除することはできません。最初にそのリソースを削除する必要があります。
  * 既存のサブネットをサイズ変更することはできません。 例えば、10.10.10.0/24 を 10.5.1.3/20 にサイズ変更することはできません
