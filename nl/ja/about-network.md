---

copyright:
  years: 2017, 2018, 2019
lastupdated: "2019-02-20"


---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:note: .note}
{:important: .important}
{:download: .download}

# VPC でのネットワーキングについて
{: #about-networking-for-vpc}

仮想プライベート・クラウド (VPC) は、お客様のアカウントに紐付けられている仮想ネットワークです。 仮想インフラストラクチャーとネットワーク・トラフィックのセグメンテーションをきめ細かく制御することによって、クラウド・セキュリティーと動的スケーリング機能を提供します。

この資料では、{{site.data.keyword.cloud}} VPC 内で適用されるネットワーキングの概念について記載します。以下のようなユース・ケースと特性について説明します。

* リージョン
* ゾーン
* 予約済み IP アドレス
* パブリック・ゲートウェイ
* vNIC インターフェース
* サブネット
* 浮動 IP アドレス
* VPN 接続

## 概説

VPC 内のネットワーキングをセットアップするには、以下を使用します。
* サブネットのインターネット・トラフィック用には、パブリック・ゲートウェイを使用します。
* VSI のインターネット・トラフィック用には、浮動 IP を使用します。
* セキュアな外部接続用には、VPN を使用します。

ただし、次のことに注意してください。
* サブネット・アドレスの CIDR 範囲の一部は、IBM によって予約されています。
* VPC 内にサブネットを作成する前に、VPC を作成する必要があります。
* IPv6 には対応していません。

オプションで、クラシック・アクセス VPC を作成して、IBM Cloud のクラシック・インフラストラクチャーに接続できます。
{:note}

以下の図の説明を次に示します。
* VPC 内の各サブネットは、オプションのパブリック・ゲートウェイ (PGW) 経由でパブリック・インターネットに接続できます。
* インターネットと VSI の間で双方向に通信できるように、VSI に浮動 IP アドレス (FIP) を割り当てることができます。
* IBM Cloud VPC 内のサブネットはプライベート接続に使用されます。サブネットは暗黙的なルーターを介してプライベート・リンク経由で相互に通信できます。経路の設定は不要です。


**図: お客様はサブネットを使用して仮想プライベート・クラウドを分割できます。必要であれば、各サブネットからパブリック・インターネットにアクセスできます。**

![VPC 接続](/images/vpc-connectivity-and-security.png)

## 用語

この[用語集](/docs/infrastructure/vpc?topic=vpc-vpc-glossary#vpc-glossary)には、この資料で使用されている IBM Cloud VPC の用語の定義と説明を記載しています。VPC を使用する際には、デプロイメントに適用される_リージョン_ と_ゾーン_ の基本的な概念について理解している必要があります。

### リージョン

リージョンとは、VPC がデプロイされる地理的領域を指す抽象的な概念です。各リージョンには複数のゾーンが含まれています。ゾーンは、独立したフォールト・ドメインを表します。 IBM Cloud VPC は、割り当てられたリージョン内の複数のゾーンにまたがるようにして作成することができます。

### ゾーン

ゾーンとは、コンピュート・リソース、ネットワーク・リソース、ストレージ・リソース、関連する冷却装置や電源をホストする物理的なデータ・センターを指す抽象的な概念です。ゾーンにより、サービスとアプリケーションが提供されます。単一障害点が共有されないようにして、耐障害性を高め、遅延時間を短くするために、ゾーンは互いから切り離されています。ゾーンには次の特性があります。

 * 各ゾーンは独立した障害ドメインであり、1 つのリージョン内の 2 つのゾーンで同時に障害が発生する可能性は極めて低いです。
 * 1 つのリージョン内のゾーン間のトラフィックの遅延時間は 2 ミリ秒未満です。

## VPC のサブネットの特性

サブネットには、指定された IP アドレス範囲 (CIDR ブロック) があります。 サブネットは 1 つのゾーンにバインドされ、複数のゾーンまたはリージョンをまたぐことはできません。 ただし、仮想プライベート・クラウドの抽象的なゾーン全体を 1 つのサブネットにすることができます。同じ IBM Cloud VPC 内の各サブネットは相互に接続されます。


### 予約済み IP アドレス

仮想プライベート・クラウドの運用時に、IBM が使用するために特定の IP アドレスが予約されています。 予約済みアドレスを次に示します (これらの IP アドレスは、サブネットの CIDR 範囲が 10.10.10.0/24 であることを前提としています)。

  * CIDR 範囲内の 1 番目のアドレス (10.10.10.0): ネットワーク・アドレス
  * CIDR 範囲内の 2 番目のアドレス (10.10.10.1): ゲートウェイ・アドレス
  * CIDR 範囲内の 3 番目のアドレス (10.10.10.2): IBM により予約済み
  * CIDR 範囲内の 4 番目のアドレス (10.10.10.3): IBM により将来の使用のために予約済み
  * CIDR 範囲内の最後のアドレス (10.10.10.255): ネットワーク・ブロードキャスト・アドレス

### サブネットの外部接続用にパブリック・ゲートウェイを使用する

**パブリック・ゲートウェイ (PGW)** を使用すると、サブネット (そのサブネットに接続されたすべての VSI を含む) からインターネットに接続できるようになります。 デフォルトでは、サブネットはプライベート・アドレスになることに注意してください。ただし、オプションで PGW を作成し、その PGW にサブネットを接続することができます。 サブネットを PGW に接続すると、そのサブネットに属するすべての VSI はインターネットに接続できます。

PGW は_多対 1 の NAT_ を使用します。これは、プライベート・アドレスを持つ数千もの VSI が 1 つのパブリック IP アドレスを使用してパブリック・インターネットと通信することを意味します。PGW を使用するだけでは、インターネットはこれらのインスタンスと接続を開始できません。 PGW とサブネットの間の接続と切り離しには、API を使用します。

ゲートウェイ・サービスについて、上述の範囲に関する概要を次の図に示します。

![ゲートウェイ・サービス](images/scope-of-gateway-services.png)

VPC 内にパブリック・ゲートウェイが作成されていますが、このゲートウェイはサブネットに接続されるまでは何も実行しません。パブリック・ゲートウェイは、ゾーン 1 つにつき 1 つしか作成できません。つまり、3 つのゾーンを含む環境では、VPC ごとに 3 つのパブリック・ゲートウェイを作成できます。
{:note}

### VSI の外部接続用に浮動 IP アドレスを使用する
**浮動 IP アドレス**は、システムによって提供される IP アドレスであり、パブリック・インターネットからアクセス可能なアドレスです。

IBM から提供される使用可能な浮動 IP アドレスのプールに含まれている浮動 IP アドレスを予約できます。また、同一仮想プライベート・クラウド内の任意のインスタンスに、そのインスタンスの vNIC を使用して、浮動 IP アドレスを関連付けたり、関連付けを解除したりできます。 浮動 IP アドレスは、ロード・バランサーや VPN ゲートウェイなど、さまざまなタイプの仮想サーバー・インスタンス (VSI) に関連付けることができます。

浮動 IP アドレスを複数のインターフェースに関連付けることはできません。個別の浮動 IP に関連付けるインターフェースを VSI で指定する必要があります。 このインターフェースにはプライベート IP アドレスも設定されます。 バックエンド・システムは、そのインターフェースの浮動 IP とプライベート IP の間で _1 対 1 の NAT_ 操作を実行します。 浮動 IP が解放されるのは、解放アクションを明示的に要求した場合に限られます。

**注:**
* **浮動 IP アドレスを VSI に関連付けると、前述の PGW の多対 1 の NAT からその VSI が削除されます。**
* **現時点では、浮動 IP では IPv4 アドレスだけがサポートされます。**
* **各自のパブリック IP アドレスを浮動 IP として使用することはできません。**

NAT 操作について詳しくは、[インターネット RFC 関連資料 ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](http://www.faqs.org/rfcs/rfc1631.html){: new_window} を参照してください。

### セキュアな外部接続用に VPN を使用する
ユーザーがインターネットから IBM Cloud VPC に安全に接続できるように、仮想プライベート・ネットワーク (VPN) サービスが用意されています。

**VPN の機能**
  * データ転送を処理するために VPN サービス (サイト間 IPSEC VPN) の CRUD (作成、読み取り、更新、削除) を行う機能。
  * VPN サービスとお客様の IBM Cloud VPC または仮想ネットワークを関連付ける機能。
  * 静的定義または動的ルーティングによってお客様のサイト内サブネットを識別する機能。
  * SHA256、AES、3DES、IKEv2 などのセキュア暗号のサポート。
  * 組み込みサービスの信頼性。
  * VPN 接続の正常性に関する継続的なモニター。
  * イニシエーター・モードとレスポンダー・モードのサポート。つまり、トンネルのどちら側からでもトラフィックを開始できます。

既知の制限事項や現在サポートされていない機能のリストについては、[既知の制限事項](/docs/infrastructure/vpc?topic=vpc-known-limitations)の資料を参照してください。

## 詳細はこちら

   * [IBM VPC セキュリティー](/docs/infrastructure/vpc-network?topic=vpc-network-security-in-your-ibm-cloud-vpc)
   * [IBM VPC アドレス、リージョン、サブネット](/docs/infrastructure/vpc-network?topic=vpc-network-working-with-ip-address-ranges-address-prefixes-regions-and-subnets)
